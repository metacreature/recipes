$.fn.ajax_form_button=function(u,e){return this.each(function(){var t=$.extend(!0,{},$.fn.ajax_form_button.defaults,e),o=$(this).closest("form"),l=$(this),i=($(this).click(function(e){e.preventDefault(),e.stopPropagation(),s()}),function(s){var a=/\r?\n/g,r=/^(?:submit|button|image|reset)$/i,n=/^(?:input|select|textarea|keygen)/i,i=/^(?:checkbox|radio)$/i;return o.map(function(){var e=$.prop(this,"elements");return e?$.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&(!$(this).is(":disabled")||s)&&n.test(this.nodeName)&&!r.test(e)&&(this.checked||!i.test(e))}).map(function(e,s){var r=$(this).val();return null==r?{name:s.name,value:null}:Array.isArray(r)?$.map(r,function(e){return{name:s.name,value:e.replace(a,"\r\n")}}):{name:s.name,value:r.replace(a,"\r\n")}}).get()}),f=function(){var e=o.find(".ajax-form-response").offset().top;$(document).scrollTop(e-30)},m=function(e,s){if(o.find(".ajax-form-response").hide().html(""),o.find(".field-error-msg").remove(),o.find(".field-line").removeClass("line-error"),"object"!=typeof e||is_empty(e))t.error&&t.error(o,l,null),o.find(".field-error").remove(),o.find(".field-line").removeClass("line-error"),o.find(".ajax-form-response").html('<span class="ajax-form-error">Es ist ein Fehler aufgetreten! Bitte versuche es sp√§ter noch einmal!</span>').show(),l.removeClass("btn-loading");else if(e.success)t.success&&t.success(o,l,e),e.message&&(o.find(".ajax-form-response").html('<span class="ajax-form-success">'+e.message+"</span>").show(),f()),o.find(".ajax-form-success-hide").hide();else if(e.warning)t.warning&&t.warning(o,l,e),e.message&&(o.find(".ajax-form-response").html('<span class="ajax-form-warning">'+e.message+"</span>").show(),f()),o.find(".ajax-form-warning-hide").hide();else{t.error&&t.error(o,l,e);var r,a,n,i=e.field_errors||e.errors;if(!is_empty(i)){for(r in i)(a=(a=o.find('[name="'+r+'"]').first()).attr("name")?a:o.find('[name="'+r+'[]"]').first()).closest(".field-line").addClass("line-error"),!0!==i[r]&&(n="string"==typeof i[r]?i[r]:i[r][0],a.closest(".field-line").prepend('<span class="field-error-msg">'+n+"</span>"));(a=o.find(".line-error [name]")).first().focus()}e.message&&(o.find(".ajax-form-response").html('<span class="ajax-form-error">'+e.message+"</span>").show(),a&&0!=a.length||f())}l.removeClass("btn-loading"),o.data("is_submitting",!1)},s=function(){if(!o.data("is_submitting")){var e=i();if("object"==typeof ihandlevars){var s={};for(r in e)s[e[r].name]=e[r].value;var r,a=[],n=array_keys(s);for(r in n.sort(),n)a.push(s[n[r]].trim());for(r in e.push({name:"secure2",value:md5(a.join("data"))}),ihandlevars)e.push({name:r,value:ihandlevars[r]})}l.addClass("btn-loading"),l.blur(),o.data("is_submitting",!0),$.ajax({type:"POST",dataType:"json",url:u,data:e,complete:function(e){m(e.responseJSON,e.status)}})}}})},$.fn.ajax_form_button.defaults={success:null,warning:null,error:null};