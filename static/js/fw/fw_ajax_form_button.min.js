$.fn.ajax_form_button=function(p,e){return this.each(function(){var m=$.extend(!0,{},$.fn.ajax_form_button.defaults,e),u=$(this).closest("form"),d=$(this);$(this).click(function(e){e.preventDefault(),e.stopPropagation(),s()});function c(){var e=u.find(".ajax-form-response").offset().top;$(document).scrollTop(e-30)}var s=function(){if(!u.data("is_submitting")){var e=(t=/\r?\n/g,o=/^(?:submit|button|image|reset)$/i,l=/^(?:input|select|textarea|keygen)/i,f=/^(?:checkbox|radio)$/i,u.map(function(){var e=$.prop(this,"elements");return e?$.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&(!$(this).is(":disabled")||i)&&l.test(this.nodeName)&&!o.test(e)&&(this.checked||!f.test(e))}).map(function(e,s){var a=$(this).val();return null==a?{name:s.name,value:null}:Array.isArray(a)?$.map(a,function(e){return{name:s.name,value:e.replace(t,"\r\n")}}):{name:s.name,value:a.replace(t,"\r\n")}}).get());if("object"==typeof ihandlevars){var s={};for(a in e)s[e[a].name]=e[a].value;var a,r=[],n=array_keys(s);for(a in n.sort(),n)r.push(s[n[a]].trim());for(a in e.push({name:"secure2",value:md5(r.join("data"))}),ihandlevars)e.push({name:a,value:ihandlevars[a]})}d.addClass("btn-loading"),d.blur(),u.data("is_submitting",!0),$.ajax({type:"POST",dataType:"json",url:p,data:e,complete:function(e){!function(e){if(u.find(".ajax-form-response").hide().html(""),u.find(".field-error-msg").remove(),u.find(".field-line").removeClass("line-error"),"object"!=typeof e||is_empty(e))m.error&&m.error(u,d,null),u.find(".field-error").remove(),u.find(".field-line").removeClass("line-error"),u.find(".ajax-form-response").html('<span class="ajax-form-error">Es ist ein Fehler aufgetreten! Bitte versuche es sp√§ter noch einmal!</span>').show(),d.removeClass("btn-loading");else if(e.success)m.success&&m.success(u,d,e),e.message&&(u.find(".ajax-form-response").html('<span class="ajax-form-success">'+e.message+"</span>").show(),c()),u.find(".ajax-form-success-hide").hide();else if(e.warning)m.warning&&m.warning(u,d,e),e.message&&(u.find(".ajax-form-response").html('<span class="ajax-form-warning">'+e.message+"</span>").show(),c()),u.find(".ajax-form-warning-hide").hide();else{var s,a,r;m.error&&m.error(u,d,e);var n=e.field_errors||e.errors;if(!is_empty(n)){for(s in n)(a=!(a=u.find('[name="'+s+'"]').first()).attr("name")?u.find('[name="'+s+'[]"]').first():a).closest(".field-line").addClass("line-error"),!0!==n[s]&&(r="string"==typeof n[s]?n[s]:n[s][0],a.closest(".field-line").prepend('<span class="field-error-msg">'+r+"</span>"));(a=u.find(".line-error [name]")).first().focus()}e.message&&(u.find(".ajax-form-response").html('<span class="ajax-form-error">'+e.message+"</span>").show(),a&&0!=a.length||c())}d.removeClass("btn-loading"),u.data("is_submitting",!1)}(e.responseJSON,e.status)}})}var i,t,o,l,f}})},$.fn.ajax_form_button.defaults={success:null,warning:null,error:null};