var slideshow_init={},slideshow=function(i,o,d,l,a){var c,r,h,u,p,f,w,v,m,n,t,_,g,e,y,x,s;slideshow_init[i]||(slideshow_init[i]=!0,window.name||(window.name="slideshow_"+Date.now()),$("#focushelper").length||$("body").prepend('<a href="javascript:;" id="focushelper" tabindex="-1"></a>'),c=null,r={},h={},u="ontouchstart"in document.documentElement,p=$("#focushelper"),f=function(){try{c&&c.abort()}catch(e){}c=null},w=function(){var e=$("#slideshow_header").data("actual");$("#slideshow .inner .slide").stop(!0,!0).each(function(){$(this).attr("id")!="slide_"+e&&$(this).remove()})},v=function(e){$(i).removeClass("active").each(function(){$(this).attr("href")==e&&$(this).addClass("active")})},m=function(a,e,n){f(),w();var t=$("#slideshow .inner"),s=$("#slideshow_header");s.data("actual",a),r[a].next?s.find(".next").removeClass("disabled"):s.find(".next").addClass("disabled"),r[a].prev?s.find(".prev").removeClass("disabled"):s.find(".prev").addClass("disabled");var s=t.find(".slide"),i=$('<div class="slide loading" id="slide_'+a+'"><div class="loading_inner"><div class="icon_loading dark"></div></div></div>');e?(t.append(i.css("margin-left",0)),s.animate({"margin-left":"-50%"},{duration:300,easing:"linear",complete:w})):(i.css("margin-left","-50%"),t.prepend(i),i.animate({"margin-left":0},{duration:300,easing:"linear",complete:w}));t=document.location.href.replace(new RegExp("[#]"+d+"=[0-9]+$","g"),"");return n?(history.pushState({slideshow:"open"},"",t+"#"+d+"="+a),$.cookie(window.name+"_historyadd_"+d,1,{path:"/"})):history.replaceState({slideshow:"open"},"",t+"#"+d+"="+a),h[a]?(l(h[a],i),v(a),i.removeClass("loading")):((t={})[d]=a,c=$.ajax({type:"POST",url:o,data:t}).done(function(e){e&&e.data&&(h[a]=e,l(h[a],i),v(a),i.removeClass("loading"))})),i},n=function(e,a,n){var t;$("#slideshow").length||(t=$('<div id="slideshow" data-opened="1" style="top: 0px; position: fixed;"><div id="slideshow_header"><a class="prev" href="#"><span class="btn"></span>'+(u?"":'<span class="area"></span>')+'</a><a class="next" href="#"><span class="btn"></span>'+(u?"":'<span class="area"></span>')+'</a><a class="close" href="#"><span class="btn"></span></a></div><div class="body"><div class="inner"></div><div class="clear"></div></div></div>'),$("body").append(t),$("#slideshow_header .close").on("click",y),$("#slideshow_header .prev").on("click",_),$("#slideshow_header .next").on("click",g),$("#slideshow_header a").on("mouseenter",x),u&&(t.find(".body").on("touchstart",function(e){touchstart_x=e.touches[0].clientX}),t.find(".body").on("touchmove",function(e){var a;null!==touchstart_x&&1==e.touches.length&&(a=150<(a=$(this).width()/3)?150:a,touchstart_x+a<e.touches[0].clientX?(touchstart_x=null,_()):touchstart_x-a>e.touches[0].clientX&&(touchstart_x=null,g()))}),t.find(".body").on("touchend",function(e){touchstart_x=null})),$("body").addClass("slideshow_opened"),t.css("top",0).css("opacity",1),0==t.find("> div > a:focus").length&&p.focus()),$("#slideshow").find(".inner").html("");var s=null;r={},$(i).each(function(){var e=$(this).attr("href");s&&(r[s].next=e),r[e]={prev:s,next:null},s=e}),m(e,!0,n)},t=function(e,a){$("body").removeClass("slideshow_opened"),e&&(h={}),$("#slideshow").data("opened")&&($("#slideshow").data("opened",!1),$("#slideshow").stop(!0,!0),$("#slideshow").animate({opacity:0},{duration:300,easing:"linear",complete:function(){$("#slideshow").remove()}})),$.cookie(window.name+"_historyadd_"+d)?($.removeCookie(window.name+"_historyadd_"+d,{path:"/"}),a&&history.back()):history.replaceState({},"",document.location.href.replace(new RegExp("[#]"+d+"=[0-9]+$","g"),""))},_=function(e){e&&e.preventDefault();e=r[$("#slideshow_header").data("actual")].prev;$("#slideshow").data("opened")&&e&&m(e,!1)},g=function(e){e&&e.preventDefault();e=r[$("#slideshow_header").data("actual")].next;$("#slideshow").data("opened")&&e&&m(e,!0)},e=function(e){e.preventDefault();e=$(this).attr("href");$("#slideshow").length||n(e,0,!0)},y=function(e){e.preventDefault(),$("#slideshow").data("opened")&&(f(),t(!1,!0))},x=function(e){$(this).parent().find("a").blur()},$(document).on("keydown",function(e){$("body").hasClass("blockkeyactions")||e.originalEvent.repeat||!$("#slideshow").data("opened")||(27===e.which?y(e):37===e.which?_(e):39===e.which&&g(e))}),s=function(){if(d){if(new RegExp("#"+d+"=[0-9]+$").test(document.location.href)){var e=document.location.href.split("#"+d+"=")[1];if(1==$(i+'[href="'+e+'"]').length)return n(e,0,!1),!0}return!1}},$(i).click(e),window.addEventListener("popstate",function(e){e.preventDefault(),e.state&&"open"==e.state.slideshow?(a&&a(e),s()&&$.cookie(window.name+"_historyadd_"+d,1,{path:"/"})):$("#slideshow").data("opened")&&(f(),t(!1,!1))}),$(document).on("click",i,e),s(d))};