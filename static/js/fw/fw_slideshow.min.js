var slideshow_init={},slideshow=function(o,d,l,r,t){var h,c,u,p,f,v,w,y,m,s,a,_,g,e,x,b,n;slideshow_init[o]||(slideshow_init[o]=!0,$("#focushelper").length||$("body").prepend('<a href="javascript:;" id="focushelper" title="focushelper"></a>'),h=null,c={},u={},p="ontouchstart"in document.documentElement,f=$("#focushelper"),v=function(){try{h&&h.abort()}catch(e){}h=null},w=function(){var e=$("#slideshow_header").data("actual");$("#slideshow .inner .slide").stop(!0,!0).each(function(){$(this).attr("id")!="slide_"+e&&$(this).remove()})},y=function(e){$(o).removeClass("active").each(function(){$(this).attr("href")==e&&$(this).addClass("active")})},m=function(t,e,s){v(),w();var a=$("#slideshow .inner"),n=$("#slideshow_header");n.data("actual",t),c[t].next?n.find(".next").removeClass("disabled"):n.find(".next").addClass("disabled"),c[t].prev?n.find(".prev").removeClass("disabled"):n.find(".prev").addClass("disabled");var n=a.find(".slide"),i=$('<div class="slide loading" id="slide_'+t+'"><div class="loading_inner"><div class="icon_loading dark"></div></div></div>');e?(a.append(i.css("margin-left",0)),n.animate({"margin-left":"-50%"},{duration:300,easing:"linear",complete:w})):(i.css("margin-left","-50%"),a.prepend(i),i.animate({"margin-left":0},{duration:300,easing:"linear",complete:w}));a=document.location.href.replace(new RegExp("[#]"+l+"=[0-9]+$","g"),"");return s?history.pushState({slideshow:"open",historyadd:$("#slideshow").attr("historyadd")},"",a+"#"+l+"="+t):history.replaceState({slideshow:"open",historyadd:$("#slideshow").attr("historyadd")},"",a+"#"+l+"="+t),u[t]?(r(u[t],i),y(t),i.removeClass("loading")):((a={})[l]=t,h=$.ajax({type:"POST",url:d,data:a}).done(function(e){e&&e.data&&(u[t]=e,r(u[t],i),y(t),i.removeClass("loading"))})),i},s=function(e,t,s,a){var n;$("#slideshow").length||(n=$('<div id="slideshow" data-opened="1" style="top: 0px; position: fixed;"><div id="slideshow_header"><a class="prev" href="#"><span class="btn"></span>'+(p?"":'<span class="area"></span>')+'</a><a class="next" href="#"><span class="btn"></span>'+(p?"":'<span class="area"></span>')+'</a><a class="close" href="#"><span class="btn"></span></a></div><div class="body"><div class="inner"></div><div class="clear"></div></div></div>'),$("body").append(n),(s||a)&&$("#slideshow").attr("historyadd","yes"),$("#slideshow_header .close").on("click",x),$("#slideshow_header .prev").on("click",_),$("#slideshow_header .next").on("click",g),$("#slideshow_header a").on("mouseenter",b),p&&(n.find(".body").on("touchstart",function(e){touchstart_x=e.touches[0].clientX}),n.find(".body").on("touchmove",function(e){var t;null!==touchstart_x&&1==e.touches.length&&(t=150<(t=$(this).width()/3)?150:t,touchstart_x+t<e.touches[0].clientX?(touchstart_x=null,_()):touchstart_x-t>e.touches[0].clientX&&(touchstart_x=null,g()))}),n.find(".body").on("touchend",function(e){touchstart_x=null})),$("body").addClass("slideshow_opened"),n.css("top",0).css("opacity",1),0==n.find("> div > a:focus").length&&f.focus()),$("#slideshow").find(".inner").html("");var i=null;c={},$(o).each(function(){var e=$(this).attr("href");i&&(c[i].next=e),c[e]={prev:i,next:null},i=e}),m(e,!0,s)},a=function(e,t){$("body").removeClass("slideshow_opened"),e&&(u={}),$("#slideshow").data("opened")&&($("#slideshow").data("opened",!1),$("#slideshow").stop(!0,!0),$("#slideshow").animate({opacity:0},{duration:300,easing:"linear",complete:function(){$("#slideshow").remove()}})),"yes"==$("#slideshow").attr("historyadd")?t&&history.back():history.replaceState({},"",document.location.href.replace(new RegExp("[#]"+l+"=[0-9]+$","g"),""))},_=function(e){e&&e.preventDefault();e=c[$("#slideshow_header").data("actual")].prev;$("#slideshow").data("opened")&&e&&m(e,!1)},g=function(e){e&&e.preventDefault();e=c[$("#slideshow_header").data("actual")].next;$("#slideshow").data("opened")&&e&&m(e,!0)},e=function(e){e.preventDefault();e=$(this).attr("href");$("#slideshow").length||s(e,0,!0,!1)},x=function(e){e.preventDefault(),$("#slideshow").data("opened")&&(v(),a(!1,!0))},b=function(e){$(this).parent().find("a").blur()},$(document).on("keydown",function(e){$("body").hasClass("blockkeyactions")||e.originalEvent.repeat||!$("#slideshow").data("opened")||(27===e.which?x(e):37===e.which?_(e):39===e.which&&g(e))}),n=function(){if(l){if(new RegExp("#"+l+"=[0-9]+$").test(document.location.href)){var t=document.location.href.split("#"+l+"=")[1];if(1==$(o+'[href="'+t+'"]').length){let e=!1;return history.state&&"yes"==history.state.historyadd&&(e=!0),s(t,0,!1,e),!0}}return!1}},$(o).click(e),window.addEventListener("popstate",function(e){e.preventDefault(),e.state&&"open"==e.state.slideshow?(t&&t(e),n()):$("#slideshow").data("opened")&&(v(),a(!1,!1))}),$(document).on("click",o,e),n())};